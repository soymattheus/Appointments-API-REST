# ğŸ“˜ Appointments API REST

API REST para gerenciamento de compromissos, desenvolvida com Node.js, MySQL e Docker.

Este documento descreve como executar o projeto em dois modos:

- ğŸ§ª **Ambiente de Teste** â†’ API + Banco rodando totalmente via Docker
- ğŸ§‘â€ğŸ’» **Ambiente de Desenvolvimento** â†’ Banco no Docker + API rodando localmente

---

# ğŸ§ª Ambiente de Teste â€” Tudo via Docker

Neste modo, **todos os serviÃ§os** (API, banco de dados e dependÃªncias) rodam dentro de containers Docker.

## ğŸš€ PrÃ©-requisitos

- Docker
- Docker Compose

---

## âš™ï¸ ConfiguraÃ§Ã£o de variÃ¡veis de ambiente

Crie um arquivo `.env` na raiz do projeto:

```env
PORT=9890

JWT_SECRET=super_secret_key
JWT_EXPIRES_IN=1d

NODE_ENV=test
DB_DIALECT=mysql
DB_HOST=service-mysql
DB_PORT=3306
DB_NAME=appointment-test
DB_USER=docker
DB_PASSWORD=docker
```

---

## â–¶ï¸ Subir o ambiente

No diretÃ³rio raiz do projeto:

```bash
docker compose down -v
docker compose up --build
```

ou

```bash
docker-compose up -d --build
```

---

## ğŸ“Š Verificar status dos containers

```bash
docker compose ps
```

Todos os serviÃ§os devem aparecer com status **Up**.

---

## ğŸ“œ Ver logs

```bash
docker compose logs -f
```

---

## ğŸŒ Acessos

- API: `http://localhost:PORTA`
- Banco de dados: "service-mysql" - conforme definido no `docker-compose.yml`

---

# ğŸ§‘â€ğŸ’» Ambiente de Desenvolvimento â€” Banco no Docker + API Local

Neste modo, apenas o **banco de dados** roda no Docker e a **API roda localmente** na mÃ¡quina.

---

## âš™ï¸ ConfiguraÃ§Ã£o de variÃ¡veis de ambiente

Crie um arquivo `.env` na raiz do projeto:

```env
PORT=9890

JWT_SECRET=super_secret_key
JWT_EXPIRES_IN=1d

NODE_ENV=development
DB_DIALECT=mysql
DB_HOST=localhost
DB_PORT=3306
DB_NAME=appointment-dev
DB_USER=docker
DB_PASSWORD=docker
```

Ajuste os valores conforme o projeto.

---

## ğŸ³ Subir somente o banco

```bash
docker compose down -v
docker compose up service-mysql
```

ou

```bash
docker compose up -d service-mysql
```

---

## ğŸ“¦ Instalar dependÃªncias

```bash
npm install
```

ou

```bash
yarn
```

---

## ğŸ“¦ Executar migrations

```bash
yarn run migration
```

---

## â–¶ï¸ Rodar API local

```bash
npm run dev
```

ou

```bash
npm start
```

A API serÃ¡ iniciada localmente e conectarÃ¡ ao banco que estÃ¡ rodando no Docker.

---

# ğŸ§ª Testar a API

Acesse no navegador ou via cliente REST:

```
http://localhost:9890
```

Teste com ferramentas como:

- Postman
- Insomnia
- curl

Exemplo:

```bash
curl http://localhost:9890/rota
```

---

# ğŸ§± Comandos Ãºteis

## â›” Parar ambiente Docker

```bash
docker compose down -v
```

---

## ğŸ”„ Reiniciar containers

```bash
docker compose restart
```

---

## ğŸ—‚ Acessar terminal de um container

```bash
docker exec -it nome_container bash
```

---

## ğŸ§  Dicas

- Verifique se o `.env` estÃ¡ compatÃ­vel com o `docker-compose.yml`
- Em caso de erro de conexÃ£o com banco:

```bash
docker logs service_mysql
```

- Para verificar se o banco estÃ¡ ativo:

```bash
docker exec -it service_mysql mysqladmin ping -u root -p
```

Deve retornar:

```
mysqld is alive
```

---

# ğŸ“ Estrutura de ambientes

| Ambiente        | Banco  | API    |
| --------------- | ------ | ------ |
| Teste           | Docker | Docker |
| Desenvolvimento | Docker | Local  |

---

# âœ… PadrÃ£o recomendado

- ğŸ§ª **Teste/QA** â†’ 100% Docker
- ğŸ§‘â€ğŸ’» **Desenvolvimento** â†’ Banco Docker + API local
- ğŸš€ **ProduÃ§Ã£o** â†’ Docker + CI/CD

---
